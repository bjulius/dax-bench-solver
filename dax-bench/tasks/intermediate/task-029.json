{
  "id": "task-029",
  "version": "1.0",
  "title": "Same Month Previous Year Comparison",
  "description": "Compare current month to the same month in the previous year using PARALLELPERIOD.",
  "complexity": "intermediate",
  "category": "time-intelligence",
  "prompt": {
    "system": "You are a DAX expert. Generate only the DAX code without any explanation or markdown formatting. Return the measure definition starting with the name followed by an equals sign.",
    "user": "Create a measure called 'Prior Year Month Sales' that returns the total Net Price for the same month in the previous year. For example, if viewing March 2021, it should return March 2020's sales.",
    "dataModelContext": "You are working with a sales database. Sales contains: Net Price (decimal), Order Date (date). Date contains: Date, Year, Month. Relationship: Date[Date] 1â†’M Sales[Order Date]."
  },
  "expectedOutput": {
    "dax": "Prior Year Month Sales = CALCULATE(SUM(Sales[Net Price]), PARALLELPERIOD('Date'[Date], -12, MONTH))",
    "alternativeCorrect": [
      "Prior Year Month Sales = CALCULATE(SUM(Sales[Net Price]), DATEADD('Date'[Date], -1, YEAR))",
      "Prior Year Month Sales = CALCULATE(SUM(Sales[Net Price]), SAMEPERIODLASTYEAR('Date'[Date]))",
      "Prior Year Month Sales = VAR PriorYearDates = PARALLELPERIOD('Date'[Date], -12, MONTH) RETURN CALCULATE(SUM(Sales[Net Price]), PriorYearDates)"
    ],
    "expectedResult": {
      "columns": ["Year", "Month", "Prior Year Month Sales"],
      "rows": [
        {"Year": 2021, "Month": 3, "Prior Year Month Sales": 890000.00},
        {"Year": 2021, "Month": 6, "Prior Year Month Sales": 1020000.00}
      ]
    }
  },
  "evaluationCriteria": {
    "syntaxWeight": 0.3,
    "outputMatchWeight": 0.7,
    "requiredElements": ["CALCULATE"],
    "partialCreditRules": [
      { "condition": "contains_PARALLELPERIOD", "credit": 0.4 },
      { "condition": "contains_SAMEPERIODLASTYEAR", "credit": 0.4 },
      { "condition": "contains_DATEADD", "credit": 0.4 },
      { "condition": "contains_CALCULATE", "credit": 0.3 }
    ],
    "bestPractices": {
      "required": [],
      "preferred": [],
      "antiPatterns": []
    },
    "performanceNotes": "SAMEPERIODLASTYEAR is the most readable; PARALLELPERIOD is more flexible"
  },
  "hints": [
    "PARALLELPERIOD shifts the entire date range by a specified interval",
    "SAMEPERIODLASTYEAR is equivalent to PARALLELPERIOD with -1 year",
    "DATEADD can also shift dates by years"
  ],
  "tags": ["measure", "parallelperiod", "sameperiodlastyear", "time-intelligence", "contoso"]
}
