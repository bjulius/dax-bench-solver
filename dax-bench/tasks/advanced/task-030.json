{
  "id": "task-030",
  "version": "1.0",
  "title": "Fiscal Year-to-Date (July Start)",
  "description": "Calculate year-to-date with a custom fiscal year starting in July using DATESYTD with year_end_date parameter.",
  "complexity": "advanced",
  "category": "time-intelligence",
  "prompt": {
    "system": "You are a DAX expert. Generate only the DAX code without any explanation or markdown formatting. Return the measure definition starting with the name followed by an equals sign.",
    "user": "Create a measure called 'Fiscal YTD Sales' that calculates the year-to-date Net Price sales using a fiscal year that starts on July 1st and ends on June 30th. For example, in September 2021, it should sum sales from July 1, 2021 through September 30, 2021.",
    "dataModelContext": "You are working with a sales database. Sales contains: Net Price (decimal), Order Date (date). Date contains: Date, Fiscal Year (integer). Relationship: Date[Date] 1â†’M Sales[Order Date]. The company's fiscal year runs from July 1 to June 30."
  },
  "expectedOutput": {
    "dax": "Fiscal YTD Sales = CALCULATE(SUM(Sales[Net Price]), DATESYTD('Date'[Date], \"6/30\"))",
    "alternativeCorrect": [
      "Fiscal YTD Sales = TOTALYTD(SUM(Sales[Net Price]), 'Date'[Date], \"6/30\")",
      "Fiscal YTD Sales = CALCULATE(SUM(Sales[Net Price]), DATESYTD('Date'[Date], \"06/30\"))",
      "Fiscal YTD Sales = TOTALYTD(SUM(Sales[Net Price]), 'Date'[Date], \"6-30\")",
      "Fiscal YTD Sales = CALCULATE(SUM(Sales[Net Price]), DATESYTD('Date'[Date], \"30/6\"))"
    ],
    "expectedResult": {
      "columns": ["Month", "Year", "Fiscal YTD Sales"],
      "rows": [
        {"Month": 7, "Year": 2021, "Fiscal YTD Sales": 1200000.00},
        {"Month": 9, "Year": 2021, "Fiscal YTD Sales": 3600000.00},
        {"Month": 6, "Year": 2022, "Fiscal YTD Sales": 14400000.00}
      ]
    }
  },
  "evaluationCriteria": {
    "syntaxWeight": 0.3,
    "outputMatchWeight": 0.7,
    "requiredElements": ["DATESYTD"],
    "partialCreditRules": [
      { "condition": "contains_DATESYTD", "credit": 0.4 },
      { "condition": "contains_TOTALYTD", "credit": 0.4 },
      { "condition": "contains_year_end_date", "credit": 0.3 },
      { "condition": "contains_CALCULATE", "credit": 0.2 }
    ],
    "bestPractices": {
      "required": [],
      "preferred": ["TOTALYTD"],
      "antiPatterns": []
    },
    "dimensionWeights": {
      "correctness": 0.50,
      "bestPractices": 0.15,
      "performance": 0.20,
      "clarity": 0.15
    },
    "performanceNotes": "TOTALYTD is syntactic sugar for CALCULATE with DATESYTD - equally efficient"
  },
  "hints": [
    "DATESYTD accepts a year_end_date parameter as the second argument",
    "The year_end_date should be June 30 for a July-start fiscal year",
    "Format can be \"6/30\", \"06/30\", or \"30/6\" depending on locale"
  ],
  "tags": ["measure", "datesytd", "totalytd", "fiscal-year", "time-intelligence", "advanced", "contoso"]
}
